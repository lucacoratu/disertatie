import ExploitModal from "@/components/ExploitModal";
import { constants } from "@/app/constants";

async function getLogExploit(log_id: string): Promise<Exploit> {
    //Create the URL where the findings classfication in string format will be fetched from
	const URL = `${constants.apiBaseURL}/logs/${log_id}/exploit`;
	//Fetch the data (revalidate after 10 minutes)
	const res = await fetch(URL, {next: {revalidate: 600}});
    //Check if an error occured
	if(!res.ok) {
		throw new Error("could not load log exploit");
	}
    const exploit: Exploit = await res.json();
    return exploit;
}


export default async function ExploitModalPage({ params }: { params: { logid: string } }) {
    const logId: string = params.logid;

    //Get the log exploit
    const logExploit: Exploit = await getLogExploit(logId);

    return (
        <ExploitModal exploit={logExploit} log_id={params.logid}/>
    );
}